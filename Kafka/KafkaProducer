import time
from kafka import KafkaProducer

producer = KafkaProducer(bootstrap_servers='10.255.175.80:9094')
topic = 'test-qsy'

def test():
    print('begin')
    n = 1
    while (1):
        future = producer.send(topic, str(n).encode())
        print(future)
        n += 1
        time.sleep(0.5)
    producer.close()
    print('done')

if __name__ == '__main__':
    test()
